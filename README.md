# Система управления багажом пассажиров

Desktop приложение на C++ с современным графическим интерфейсом и PostgreSQL базой данных для управления данными о багаже пассажиров.

**Курсовая работа по теме №96**: "Разработка программного обеспечения для создания и обработки сведений о багаже пассажиров"

**PostgreSQL** - профессиональная СУБД вместо бинарных файлов
**Современный UI** 
**Docker** - полная контейнеризация приложения и БД
**Автоматическая инициализация** - БД создается и заполняется тестовыми данными автоматически

## Возможности

Приложение реализует все 8 обязательных функций:

1. **Создать файл** - создание нового файла базы данных с заданной структурой
2. **Показать содержимое** - вывод всех записей из файла в таблицу
3. **Фильтр пассажиров** - поиск пассажиров с 1 вещью весом 20-30 кг
4. **Создать файл сводки** - формирование текстового файла с номером рейса, ФИО и общим весом багажа
5. **Показать файл сводки** - открытие текстового файла сводки
6. **Добавить запись** - добавление новой записи о багаже пассажира
7. **Удалить по рейсам** - удаление записей по заданным номерам рейсов
8. **Изменить количество вещей** - изменение количества и весов вещей для указанного пассажира

## Структура данных

Каждая запись содержит:
- **№ рейса** - номер рейса (строка)
- **Ф.И.О. пассажира** - полное имя пассажира (строка)
- **Количество вещей** - от 1 до 5 штук
- **Вес каждой вещи** - в килограммах (положительное число)

## Требования

### Вариант 1: Запуск через Docker (РЕКОМЕНДУЕТСЯ)
- **Docker**: версия 20.10+
- **Docker Compose**: версия 1.29+
- **X11** (для GUI на Linux/macOS)

### Вариант 2: Локальная сборка
- **ОС**: Linux, Windows, macOS
- **Компилятор**: GCC 7+, Clang 6+, MSVC 2017+ с поддержкой C++17
- **Qt**: версия 5.15 или 6.x (с модулем Qt SQL)
- **PostgreSQL**: версия 12+
- **CMake**: версия 3.16 или выше

## Быстрый старт с Docker

```bash
# 1. Клонируйте репозиторий
git clone <URL>
cd baggage_system

# 2. Разрешите X11 для GUI (Linux/macOS)
xhost +local:docker

# 3. Запустите приложение
docker-compose up --build
```

Готово! Приложение откроется автоматически с подключенной PostgreSQL БД.


---

## Локальная сборка

### Установка зависимостей

#### Ubuntu/Debian
```bash
sudo apt-get update
sudo apt-get install build-essential cmake qt6-base-dev libqt6sql6-psql postgresql
# Или для Qt5:
# sudo apt-get install build-essential cmake qtbase5-dev libqt5sql5-psql postgresql
```

#### Fedora/RHEL
```bash
sudo dnf install gcc-c++ cmake qt6-qtbase-devel qt6-qtbase-postgresql postgresql-server
# Или для Qt5:
# sudo dnf install gcc-c++ cmake qt5-qtbase-devel qt5-qtbase-postgresql postgresql-server
```

#### macOS (с Homebrew)
```bash
brew install cmake qt@6 postgresql
# Или для Qt5:
# brew install cmake qt@5 postgresql
```

#### Windows
1. Установите [Qt](https://www.qt.io/download) (Qt Online Installer) с модулем PostgreSQL
2. Установите [CMake](https://cmake.org/download/)
3. Установите [PostgreSQL](https://www.postgresql.org/download/windows/)
4. Установите компилятор (MinGW, MSVC или Clang)

## Сборка проекта

### 1. Настройка PostgreSQL

```bash
# Запустите PostgreSQL
sudo systemctl start postgresql  # Linux
# или
brew services start postgresql   # macOS

# Создайте базу данных
sudo -u postgres psql
CREATE DATABASE baggage_db;
CREATE USER postgres WITH PASSWORD 'postgres';
GRANT ALL PRIVILEGES ON DATABASE baggage_db TO postgres;
\q

# Инициализируйте схему (опционально - создастся автоматически)
psql -U postgres -d baggage_db -f init-db.sql
```

### 2. Сборка приложения

#### Linux/macOS

```bash
# Создайте директорию для сборки
mkdir build
cd build

# Сгенерируйте файлы сборки
cmake ..

# Соберите проект
cmake --build .

# Запустите приложение
./BaggageSystem
```

### Windows (MinGW)

```cmd
mkdir build
cd build
cmake -G "MinGW Makefiles" ..
cmake --build .
BaggageSystem.exe
```

### Windows (Visual Studio)

```cmd
mkdir build
cd build
cmake -G "Visual Studio 17 2022" ..
cmake --build . --config Release
Release\BaggageSystem.exe
```

## Использование

### Быстрый старт

1. **Запустите приложение**
2. **Создайте новый файл**: Нажмите "1. Создать файл" и выберите место сохранения
3. **Добавьте записи**: Нажмите "6. Добавить запись" и заполните форму
4. **Просмотрите данные**: Все записи отображаются в главной таблице
5. **Сохраните файл**: Меню "Файл" → "Сохранить"

### Работа с функциями

#### Функция 3: Фильтр пассажиров
Нажмите кнопку "3. Фильтр (1 вещь, 20-30 кг)" для поиска пассажиров, у которых ровно одна вещь весом от 20 до 30 кг. Результаты отображаются в отдельном окне.

#### Функция 4-5: Файл сводки
1. Нажмите "4. Создать файл сводки"
2. Выберите имя файла (будет создан текстовый файл)
3. Нажмите "5. Показать файл сводки" для просмотра

#### Функция 7: Удаление по рейсам
1. Нажмите "7. Удалить по рейсам"
2. Введите номера рейсов (каждый с новой строки)
3. Подтвердите удаление

#### Функция 8: Изменение количества вещей
1. Нажмите "8. Изменить кол-во вещей"
2. Введите точное Ф.И.О. пассажира
3. Укажите новое количество вещей и их веса

### Валидация данных

Приложение проверяет:
- ✓ Количество вещей: от 1 до 5
- ✓ Вес каждой вещи: > 0 кг и ≤ 100 кг
- ✓ Заполнение всех обязательных полей
- ✓ Корректность ввода данных

## Структура проекта

```
baggage_system/
├── CMakeLists.txt           # Файл сборки CMake
├── README.md                # Документация
├── include/                 # Заголовочные файлы
│   ├── BaggageRecord.h      # Класс записи о багаже
│   ├── BaggageManager.h     # Менеджер данных
│   ├── MainWindow.h         # Главное окно
│   ├── AddRecordDialog.h    # Диалог добавления
│   ├── FilterDialog.h       # Диалог фильтрации
│   ├── DeleteByFlightDialog.h  # Диалог удаления
│   └── ChangeItemsDialog.h  # Диалог изменения
└── src/                     # Исходные файлы
    ├── main.cpp             # Точка входа
    ├── BaggageRecord.cpp
    ├── BaggageManager.cpp
    ├── MainWindow.cpp
    ├── AddRecordDialog.cpp
    ├── FilterDialog.cpp
    ├── DeleteByFlightDialog.cpp
    └── ChangeItemsDialog.cpp
```

## Технологии

- **Язык**: C++17
- **GUI фреймворк**: Qt 5.15+ / Qt 6.x (Qt Widgets + Qt SQL)
- **База данных**: PostgreSQL 12+
- **Система сборки**: CMake 3.16+
- **Контейнеризация**: Docker + Docker Compose
- **Архитектура**: Model-View + Database Layer
- **Дизайн**: QSS (Qt Style Sheets) с Material Design градиентами

## Особенности реализации

### База данных (PostgreSQL)
- **DatabaseManager** - синглтон для работы с PostgreSQL
- Автоматическое создание таблиц и индексов
- Транзакционность и надежность данных
- Поддержка до 10,000+ записей
- Подключение через переменные окружения

### Модель данных
- **BaggageRecord** - класс для хранения данных об одной записи
- Встроенная валидация на уровне модели
- Поддержка сериализации для БД

### Менеджер данных
- **BaggageManager** - прокси для DatabaseManager
- Кеширование для быстрого доступа
- Реализация всех 8 требуемых функций
- Обработка ошибок БД операций

### Графический интерфейс
- Современный дизайн с градиентами (#667eea → #764ba2)
- Адаптивная таблица с чередующимися цветами
- Стильные кнопки с hover эффектами
- Меню и панель инструментов с анимациями
- Специализированные диалоги для каждой операции
- Русский язык интерфейса
- QSS стили (Material Design inspired)

## Примеры данных

### Пример записи
```
№ рейса: SU1234
Ф.И.О.: Иванов Иван Иванович
Количество вещей: 3
Веса вещей: 15.5 кг, 22.0 кг, 18.3 кг
Общий вес: 55.8 кг
```

### Формат файла сводки
```
№ рейса    Ф.И.О. пассажира           Общий вес багажа (кг)
=======================================================
SU1234     Иванов Иван Иванович       55.80
AF567      Петров Петр Петрович       25.00
BA890      Сидорова Мария Сергеевна   42.50
```

## Устранение неполадок

### Ошибка: "Qt не найден"
Убедитесь, что Qt установлен и путь к нему добавлен в переменную окружения `CMAKE_PREFIX_PATH`:
```bash
export CMAKE_PREFIX_PATH=/путь/к/qt6
# Например: export CMAKE_PREFIX_PATH=/usr/lib/qt6
```

### Ошибка при сборке: "C++17 не поддерживается"
Обновите компилятор до версии с поддержкой C++17:
- GCC 7+
- Clang 6+
- MSVC 2017+

### Приложение не запускается
Проверьте наличие библиотек Qt в системе:
```bash
ldd ./BaggageSystem  # Linux
otool -L ./BaggageSystem  # macOS
```
